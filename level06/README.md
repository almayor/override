## Level06

В этом уровне программа просит ввести login и подходящий serial number. Далее строка login специальным образом хэшируется, и, если полученный хэш совпадает с serial number, запускается оболочка.

Можно попробовать восстановаить алгоритм хэширования на основе бинарного файла (reverse-engineering). Но есть и более простой подход: запустить программу gdb и считать хэш из регистров.

Есть препятствие: программа проверяет, что она запускается вне каких-либо дебаггеров, с помощью вызова `ptrace`. Однако эту защиту легко обойти: можно вручную переписать значение регистра `$eax`, возвращаемого `ptrace`, на нуль.

Итого:

```
> gdb level06
(gdb) disas auth
...
0x080487b5 <+109>:	call   0x80485f0 <ptrace@plt>
0x080487ba <+114>:	cmp    $0xffffffff,%eax
...
0x08048866 <+286>:	cmp    -0x10(%ebp),%eax
0x08048869 <+289>:	je     0x8048872 <auth+298>
...
(gdb) b *0x080487ba
(gdb) b *0x08048866
(gdb) run
-> Enter Login: blabla
-> Enter Serial: 0

Breakpoint 1, 0x080487ba in auth ()
(gdb) set $eax = 0
(gdb) n
Breakpoint 2, 0x08048866 in auth ()
(gdb) x/d ($ebp - 0x10)
0xffffd698:	6232821
```

Мы получили пару `(login, serial) = (blabla, 6232821)`. Она дает нам возможность запустить оболочку как пользователь `level07`.

